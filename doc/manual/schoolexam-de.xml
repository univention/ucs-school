<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE chapter [
	<!ENTITY % extensions SYSTEM "../stylesheets/macros.ent" >
	<!ENTITY % DocBookDTD PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
	"http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd">
	<!ENTITY % entities SYSTEM "../stylesheets/macros-de.ent" >
	%extensions;
	%DocBookDTD;
	%entities;
]>
<chapter id="school:exam">
	<title>Klassenarbeitsmodus</title>
	<para>
		Der Klassenarbeitsmodus ermöglicht die gezielte Einschränkung der Computernutzung für Schüler einer Klasse.
		Über das UMC-Modul für den Klassenarbeitsmodus kann ein Lehrer einen Klassenraum für die exklusive Nutzung durch bestimmte Gruppen konfigurieren.
		Der Klassenarbeitsmodus bietet darüber hinaus auch einen direkten Zugriff auf die Funktionalitäten der Materialverteilung.
		Hintergründe zur technischen Umsetzung werden in <xref linkend="school:exam:concept"/> und mögliche Konfigurationsschnittstellen in <xref linkend="school:exam:configuration"/> genannt.
	</para>
	<para>
		Für die Dauer des Klassenarbeitsmodus werden die ausgewählten Schüler und Räume in eine speziell benannte Gruppe aufgenommen.
		Dies macht es möglich mit Hilfe von Windows-Gruppenrichtlinien spezifische Einschränkungen für die Benutzung von Windows-Rechnern im gewählten Raum zu definieren,
		wie z.B. die Vorgabe eines Proxy-Servers zur Filterung des Internetzugriffs, die Einschränkung den Zugriffs auf USB-Speicher und andere Wechselmedien oder auch die Sperrung bestimmter Programme.
		Einsatzmöglichkeiten für Gruppenrichtlinien werden in <xref linkend="school:exam:gpo"/> beispielhaft beschrieben.
	</para>

	<section id="school:exam:concept">
		<title>Technische Hintergründe</title>
		<para>
		    Zur Verwendung des Klassenarbeitsmodus sind folgende Voraussetzungen zu erfüllen:
			<itemizedlist>
			  <listitem>
				<simpara>
				Verwendung einer Samba 4-Domäne (AD-Domäne)
				</simpara>
			  </listitem>
			  <listitem>
				<simpara>
				Einsatz von Windows XP oder höher auf den Prüfungscomputern
				</simpara>
			  </listitem>
			  <listitem>
				<simpara>
				Import von Computerkonten und Zuordnung der Computer zu Computerräumen
				</simpara>
			  </listitem>
			  <listitem>
				<simpara>
				Die Verwendung des UCS@school-HTTP-Proxys durch die Prüfungscomputer zur Filterung des Internetzugriffs
				</simpara>
			  </listitem>
			</itemizedlist>
		</para>
		<para>
			Eine neue Klassenarbeit kann über das Modul <guimenu>Klassenarbeit starten</guimenu> begonnen werden.
			Beim Durchlaufen der einzelnen Schritte werden von der Lehrkraft ein Name für die Klassenarbeit und die teilnehmenden Klassen/Arbeitsgruppen ausgewählt.
			Zusätzlich können für die Arbeit notwendige Dateien hochgeladen sowie Computerraumeinstellungen ausgewählt werden.
		</para>
		<para>
			Damit Schülern nicht die Möglichkeit gegeben wird, auf ihr bisheriges Heimatverzeichnis zuzugreifen, werden zum Zeitpunkt des Einrichtens der Klassenarbeit für die ausgewählten Schülerkonten spezielle Klassenarbeitskonten neu angelegt.
			Der Loginname für das Klassenarbeitskonto setzt sich aus einem festgelegten Präfix (standardmäßig <literal>exam-</literal>) und dem normalen Benutzernamen zusammen.
			Bspw. wird für den Benutzer <systemitem class="username">anton123</systemitem> das Klassenarbeitskonto <systemitem class="username">exam-anton123</systemitem> angelegt, mit dem er sich während der Klassenarbeit anmelden muss.
			Für das Klassenarbeitskonto wird ein neues Heimatverzeichnis erzeugt, Passwörter und andere Konteneinstellungen werden jedoch aus dem ursprünglichen Benutzerkonto direkt übernommen.
		</para>
		<para>
			Alle Klassenarbeitskonten der Schüler sowie alle Rechner des Computerraumes sind für den Zeitraum der Klassenarbeit Mitglieder der Gruppe <systemitem class="groupname">OU&lt;OU-Name&gt;-Klassenarbeit</systemitem>.
			Durch diese Gruppe können spezifische Einschränkungen für Schüler und Rechner mit Hilfe von Windows-Gruppenrichtlinien vorgenommen werden (siehe <xref linkend="school:exam:gpo"/>).
		</para>
		<note>
			<para>
				Damit die Einstellungen der Gruppenrichtlinien für die Rechner entsprechend greifen, ist es wichtig, dass die Schülerrechner des Computerraumes nach dem Einrichten einer Klassenarbeit neu gestartet werden.
				Dieser Vorgang wird durch das UMC-Modul <guimenu>Klassenarbeit starten</guimenu> unterstützt, indem alle eingeschalteten Rechner automatisch neu gestartet werden können.
				Zusätzlich ist es aus dem selben Grund wichtig, dass nach Beenden einer Klassenarbeit die Schülerrechner entweder ausgeschaltet oder neu gestartet werden.
				Nur so können die ursprünglichen Einstellungen der Gruppenrichtlinien wieder wirksam werden.
			</para>
			<para>
				Damit leicht erkannt werden kann, dass die Gruppenrichtlinien für den Klassenarbeitsmodus an den Rechnern wirksam sind, empfehlen wir, bspw. ein optisch klar zu unterscheidendes Hintergrundbild über die Richtlinien zuzuweisen.
			</para>
		</note>
	</section>

	<section id="school:exam:configuration">
		<title>Konfiguration</title>
		<para>
			Für die Konfiguration des Klassenarbeitsmodus gibt es eine Reihe von &ucsUCRV;n.
			Diese werden im folgenden aufgelistet und kurz erläutert. 
		</para>
		<para>
			Die nachfolgenden &ucsUCRV;n können geändert werden, um LDAP-Eigenschaften der Klassenarbeitskonten, -gruppen und -container anzupassen. Sofern diese Variablen manuell gesetzt werden, ist zu beachten, dass es sich dabei um globale Einstellungen handelt und diese Variablen sowohl auf dem &ucsMaster; als auch auf den Schulservern identische Werte aufweisen müssen.
			<itemizedlist>
				<listitem>
					<simpara>
					<envar>ucsschool/ldap/default/userprefix/exam</envar> gibt den Präfix an, der dem ursprünglichen Benutzernamen im Klassenarbeitskonto vorangestellt wird. Er ist standardmäßig auf <literal>exam-</literal> gesetzt.
					</simpara>
				</listitem>
				<listitem>
					<simpara>
					<envar>ucsschool/ldap/default/groupname/exam</envar> bezeichnet die Gruppe, der alle Klassenarbeitskonten sowie Klassenarbeitsrechner zugeordnet sind. Über diese Gruppe können spezifische Windows-Gruppenrichtlinien für den Klassenarbeitsmodus gesetzt werden. Der Standardname für diese Gruppe ist <systemitem class="groupname">OU%(ou)s-Klassenarbeit</systemitem>, wobei <literal>%(ou)s</literal> vom System automatisch durch den Namen der OU ausgetauscht wird.
					</simpara>
				</listitem>
				<listitem>
					<simpara>
					<envar>ucsschool/ldap/default/container/exam</envar> ist der Name des Containers, unterhalb dem die Klassenarbeitskonten gespeichert werden. Standardmäßig ist der Name auf <literal>examusers</literal> gesetzt. Die LDAP-Position des Containers ist direkt unterhalb der Schul-OU.
					</simpara>
				</listitem>
			</itemizedlist>
		</para>
		<para>
			Das UMC-Modul zum Einrichten einer Klassenarbeit bietet die Möglichkeit bestimmte Standardwerte zu definieren, um das Starten einer Klassenarbeit zu vereinfachen; dazu gehören:
			<itemizedlist>
				<listitem>
					<simpara>
					<envar>ucsschool/exam/default/room</envar> definiert den vorausgewählten Raum für eine neue Klassenarbeit. Der Eintrag beinhaltet den LDAP-Namen des Raumes (inklusive des Schul-OU-Präfxies), also bspw. <userinput>meineschule-PC Raum</userinput>. Ist die Variable nicht gesetzt, wird standardmäßig der alphabetisch erste Raum ausgewählt.
					</simpara>
				</listitem>
				<listitem>
					<simpara>
					<envar>ucsschool/exam/default/shares</envar> gibt den vorausgewählten Freigabezugriff für eine neue Klassenarbeit an. Mögliche Werte sind <literal>all</literal> für Zugriff auf alle Freigaben ohne Einschränkungen sowie <literal>home</literal> für eingeschränkten Zugriff auf lediglich das Heimatverzeichnis des (Klassenarbeits-)Benutzerkonto. Ist die Variable nicht gesetzt, wird standardmäßig nur der Zugriff auf das Homeverzeichnis freigegeben.
					</simpara>
				</listitem>
				<listitem>
					<simpara>
					<envar>ucsschool/exam/default/internet</envar> definiert die vorausgewählte Internetregel für eine neue Klassenarbeit. Mögliche Werte umfassen die Namen aller Internetregeln wie sie im UMC-Modul <guimenu>Internetregeln definieren</guimenu> angezeigt werden. Normalerweise werden die globalen Standardeinstellungen verwendet.
					</simpara>
				</listitem>
				<listitem>
					<simpara>
						<envar>ucsschool/exam/default/checkbox/distribution</envar>
						definiert, ob beim Starten des Klassenarbeitsmodus das Auswahlkästchen <guimenu>Unterrichtsmaterial verteilen</guimenu> automatisch vorausgewählt ist. Mögliche Werte sind <literal>true</literal> (Auswahlkästchen vorausgewählt) oder <literal>false</literal> (Auswahlkästchen nicht vorausgewählt).
					</simpara>
				</listitem>
				<listitem>
					<simpara>
						<envar>ucsschool/exam/default/checkbox/proxysettings</envar>
						definiert, ob beim Starten des Klassenarbeitsmodus das Auswahlkästchen <guimenu>Internetregeln definieren</guimenu> automatisch vorausgewählt ist. Mögliche Werte sind <literal>true</literal> (Auswahlkästchen vorausgewählt) oder <literal>false</literal> (Auswahlkästchen nicht vorausgewählt).
					</simpara>
				</listitem>
				<listitem>
					<simpara>
						<envar>ucsschool/exam/default/checkbox/sharesettings</envar>
						definiert, ob beim Starten des Klassenarbeitsmodus das Auswahlkästchen <guimenu>Freigabezugriff konfigurieren</guimenu> automatisch vorausgewählt ist. Mögliche Werte sind <literal>true</literal> (Auswahlkästchen vorausgewählt) oder <literal>false</literal> (Auswahlkästchen nicht vorausgewählt).
					</simpara>
				</listitem>
			</itemizedlist>
		</para>
	</section>

	<section id="school:exam:gpo">
		<title>Beispiele für Gruppenrichtlinien</title>
		<para>
			Gruppenrichtlinien werden von einem Windows System aus mit Hilfe der Gruppenrichtlinienverwaltung (GPMC) angelegt und bearbeitet.
			Im Folgenden ist die Konfiguration der Gruppenrichtlinien von einem Windows 7 System aus beschrieben auf dem dazu die Gruppenrichtlinienverwaltung (GPMC) aus den Remote System Administration Tools (RSAT) installiert sein muss.
		</para>
		<para>
		Alle Gruppenrichtlinieneinstellungen können je nach Bedarf gesammelt über ein Gruppenrichtlinienobjekt vorgenommen werden oder auf separate Objekte verteilt werden. Um den Bezug zwischen einem ausgewählten Gruppenrichtlinienobjekt und Objekten im Samba-Verzeichnisdienst herzustellen, kann es mit einer Organisationseinheit (OU) verknüpft werden, z.B. der Schul-OU. Einige der hier beispielhaft beschriebenen Gruppenrichtlinieneinstellungen wirken sich nur auf Benutzer- und andere nur auf Computer-Konten aus. Da die Einstellungen eines Gruppenrichtlinienobjekts nur für Objekte ausgewertet werden, die unterhalb des speziellen Verzeichniszweigs liegen, mit dem es verknüpft wurde, ist es wichtig, dass das entsprechende Gruppenrichtlinienobjekt hinreichend hoch in der hierarchischen Objektordnung verknüpft wird.
		</para>
		<para>
			Einige der genannten Gruppenrichtlinien-Einstellungen beziehen sich auf den Bereich der Computerkonfiguration und werden nur beim Systemstart korrekt von den entsprechenden Windows-Komponenten ausgewertet. Für solche Einstellungen ist daher ein Neustart der Windows-Arbeitsplatzsysteme nach Aktivierung des Klassenarbeitsmodus notwendig.
		</para>
		<note>
			<simpara>
			Zu diesem Thema ist auch ein Hinweis von Microsoft zu Windows XP Systemen zu beachten: <quote>Jede Version von Windows XP Professional stellt eine Funktion zur Optimierung für schnelles Anmelden zur Verfügung. Computer mit diesen Betriebssystemen warten standardmäßig beim Starten nicht auf den Start des Netzwerks. Nach der Anmeldung werden die Richtlinien im Hintergrund verarbeitet, sobald das Netzwerk zur Verfügung steht. Dies bedeutet, dass der Computer bei der Anmeldung und beim Start weiterhin die älteren Richtlinieneinstellungen verwendet. Daher sind für Einstellungen, die nur beim Start oder bei der Anmeldung angewendet werden können (z. B. Softwareinstallation und Ordnerumleitung), möglicherweise nach dem Ausführen der ersten Änderung am Gruppenrichtlinienobjekt mehrere Anmeldungen durch den Benutzer erforderlich. Diese Richtlinie wird gesteuert durch die Einstellung in <filename>Computerkonfiguration\Administrative Vorlagen\System\Anmeldung\Beim Neustart des Computers und bei der Anmeldung immer 
auf das Netzwerk warten</filename>. Diese Funktion ist in den Betriebssystemversionen von Windows 2000 oder Windows Server 2003 nicht verfügbar.</quote>
			<footnote><para><ulink url="http://technet.microsoft.com/de-de/library/cc785665(v=ws.10).aspx"/></para></footnote>
			</simpara>
		</note>
		<section id="school:exam:gpo:general">
		  <title>Generelle Hinweise zu Gruppenrichtlinien und Administrativen Vorlagen</title>
		  <para>
			Auf dem Schulserver sollte das Verzeichnis
			<filename>/var/lib/samba/sysvol/<replaceable>DomänenNameDerUCS@schoolUmgebung</replaceable>/Policies/PolicyDefinitions/</filename>
			angelegt werden. Sobald dieses Verzeichnis angelegt ist, bevorzugt das Windows-Programm zur
			Gruppenrichtlinienverwaltung die dort hinterlegten Administrativen Vorlagen im ADMX-Format vor den
			lokal auf dem Windows 7 System installierten Administrativen Vorlagen.
		  </para>
		  <para>
			Da in den nachfolgenden Abschnitten zusätzliche Administrative Vorlagen verwendet
			werden, die ebenfalls in dem oben genannten Verzeichnis abzulegen sind, wird empfohlen, nach dem
			Erstellen des Verzeichnisses einmalig die lokal installierten Administrativen Vorlagen aus dem
			Verzeichnis <filename class="directory">C:\Windows\PolicyDefinitions</filename> in das neue Verzeichnis zu
			kopieren. Da das Verzeichnis serverseitig unterhalb der <filename>SYSVOL</filename>-Freigabe liegt,
			wird es per Voreinstellung auf alle Samba 4-Server der Domäne synchronisiert. Die Administrativen
			Vorlagen sind an sich keine Gruppenrichtlinien, sie dienen nur zur Erweiterung der
			Einstellungsmöglichkeiten die das Windows Programm zur Gruppenrichtlinienverwaltung dem
			Administrator zur Auswahl anbietet. Für neuere Windows- Versionen, wie z.B. Windows 8 stellt
			Microsoft aktualisierte Administrative Vorlagen zum Download zur Verfügung.
		  </para>
		  <para>
			Grundsätzlich können Gruppenrichtlinien im Samba-Verzeichnisdienst mit Organisationseinheiten (OU) und der LDAP-Basis verknüpft werden. Im &ucsUAS;-Kontext werden jedoch nur Verknüpfungen unterhalb der Schul-OU auch automatisch in das OpenLDAP-Verzeichnis synchronisiert. Verknüpfungen mit der LDAP-Basis werden z.B. durch OpenLDAP-Zugriffsbeschränkungen blockiert, damit sich eine Anpassung der damit verknüpften Gruppenrichtlinien durch einen Schul-Administrator nicht auch auf alle anderen Schulen auswirkt. Eine solche Änderung wird im S4-Connector auf der Schule als Reject notiert. Wenn tatsächlich gewünscht ist, eine Änderung der Gruppenrichtlinienverknüpfung an der LDAP-Basis und unter <uri>OU=Domain Controllers</uri> auch in das OpenLDAP-Verzeichnis und damit an alle Schulen zu synchronisieren, kann auf dem Schulserver folgender Befehl mit dem zentralen Administrator-Passwort ausgeführt werden:
			<programlisting language="sh">
eval "$(ucr shell)"
/usr/share/univention-s4-connector/msgpo.py --write2ucs \
  --binddn "uid=Administrator,cn=users,$ldap_base" --bindpwd &lt;password&gt;</programlisting>
			Der S4-Connector erkennt eine kurze Zeit später bei dem nächsten Resync, dass der Reject aufgelöst wurde.
		  </para>
		</section>
		<section id="school:exam:gpo:group">
			<title>Windows-Anmeldung im Prüfungsraum auf Mitglieder der Klassenarbeitsgruppe beschränken</title>
			<para>
				Da das im folgenden konfigurierte Gruppenrichtlinienobjekt je nach Verknüpfung im Samba-Verzeichnisdienst die Anmeldung an betroffenen Windows-Arbeitsplatzsystemen einschränkt, wird dringend empfohlen, als erstes die Anwendung der neuen Gruppenrichtlinie auf solche Windows-Arbeitsplatzsysteme einzuschränken, auf die sie sich später im Klassenarbeitsmodus auswirken soll. Dies geschieht am einfachsten über die Anpassung der Sicherheitsfilterung, die im Folgenden beschrieben ist.
			</para>
			<para>
			Damit die Gruppenrichtlinieneinstellungen von Windows-Arbeitsplatzrechnern ausgewertet werden, ist es notwendig, einen Bezug zwischen dem angelegten Gruppenrichtlinienobjekt und den Rechnerobjekten im Samba-Verzeichnisdienst herzustellen. Um dies zu erreichen kann das Gruppenrichtlinienobjekt mit einer Organisationseinheit (OU) verknüpft werden, die den Rechnerobjekten im Verzeichnisbaum übergeordnet ist, in der Regel mit der Schul-OU.
			</para>
			<section id="school:exam:gpo:computer">
				<title>Anwendungsbereich der GPO auf Klassenarbeitscomputer einschränken</title>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In der Baumdarstellung der Gruppenrichtlinienverwaltung die Gruppenrichtlinie anklicken.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Auf dem geöffneten Reiter <emphasis>Bereich</emphasis> im Abschnitt <emphasis>Sicherheitsfilterung</emphasis> die Schaltfläche <emphasis>Hinzufügen</emphasis> betätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das Eingabefeld <emphasis>Geben Sie die zu verwendenden Objektnamen ein</emphasis> den Namen der Klassenarbeitsgruppe (<systemitem class="groupname">OU<replaceable>NameDerOU</replaceable>-Klassenarbeit</systemitem>, z.B. <userinput>OUgym17-Klassenarbeit</userinput>) eintragen und den Dialog mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Auf dem geöffneten Reiter <emphasis>Bereich</emphasis> im Abschnitt <emphasis>Sicherheitsfilterung</emphasis> die Gruppe <emphasis lang="en">Authenticated Users</emphasis> auswählen und die Schaltfläche <emphasis>Entfernen</emphasis> betätigen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section id="school:exam:gpo:user">
				<title>Einschränkung der Windows-Anmeldung auf Klassenarbeitsbenutzerkonten und Lehrer</title>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung das Gruppenrichtlinienobjekt zur Bearbeitung öffnen (Kontextmenü des GPO in der Baumdarstellung).
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im neu geöffneten Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Windows-Einstellungen</guisubmenu> &ar; <guisubmenu>Sicherheitseinstellungen</guisubmenu> &ar; <guisubmenu>Lokale Richtlinien</guisubmenu> &ar; <guisubmenu>Zuweisen von Benutzerrechten</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im neu geöffneten Richtlinien-Dialog <emphasis>Eigenschaften von Lokal anmelden zulassen</emphasis> auf dem Reiter <emphasis>Sicherheitsrichtlinie</emphasis> die Option <emphasis>Diese Richtlinieneinstellung definieren</emphasis> aktivieren.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Dann die Schaltfläche <emphasis>Benutzer oder Gruppe hinzufügen</emphasis> betätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das Eingabefeld <emphasis>Benutzer und Gruppennamen</emphasis> den Namen <userinput>Administratoren</userinput> eintragen und den Dialog mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Erneut die Schaltfläche <emphasis>Benutzer oder Gruppe hinzufügen</emphasis> betätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im neu geöffneten Dialog die Schaltfläche <emphasis>Durchsuchen</emphasis> betätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das Eingabefeld <emphasis>Geben Sie die zu verwendenden Objektnamen ein</emphasis> den Namen der Klassenarbeitsgruppe (<systemitem class="groupname">OU<replaceable>NameDerOU</replaceable>-Klassenarbeit</systemitem>, z.B. <userinput>OUgym17-Klassenarbeit</userinput>) eintragen und den Dialog mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Den Dialog <emphasis>Benutzer oder Gruppe hinzufügen</emphasis> ebenfalls mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Erneut die Schaltfläche <emphasis>Benutzer oder Gruppe hinzufügen</emphasis> betätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im neu geöffneten Dialog die Schaltfläche <emphasis>Durchsuchen</emphasis> betätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das Eingabefeld <emphasis>Geben Sie die zu verwendenden Objektnamen ein</emphasis> den Namen der Lehrergruppe (<systemitem class="groupname">lehrer-<replaceable>NameDerOU</replaceable></systemitem>, z.B. <userinput>lehrer-gym17</userinput>) eintragen und den Dialog mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Den Dialog <emphasis>Benutzer oder Gruppe hinzufügen</emphasis> ebenfalls mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Den Richtlinien-Dialog <emphasis>Eigenschaften von Lokal anmelden zulassen</emphasis> mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
		</section>


		<section id="school:exam:gpo:usb">
			<title>Zugriff auf USB-Speicher und Wechselmedien einschränken</title>
			<para>
				Zur Einschränkung des Zugriffs auf USB-Speicher und Wechselmedien sind je nach Windowsversion zwei Fälle zu beachten: einerseits die Einschränkung der Benutzung bereits installierter Gerätetreiber und andererseits die Einschränkung der Installation neuer Gerätetreiber.
			</para>
			<para>
				Während für Windows XP beide Einschränkungen notwendig sind, bietet Windows 7 durch erweiterte Richtlinien vereinfachte und erweiterte Kontrollmöglichkeiten. In Mischumgebungen ist eine Kombination der skizzierten Einstellungen zu empfehlen.
			</para>
			<note>
				<simpara>
				Die Liste der hier erwähnten Einstellungen erhebt nicht den Anspruch auf Vollständigkeit. Es ist notwendig die Einstellungen entsprechend der lokalen Gegebenheiten zu testen. Insbesondere sollte folgende Microsoft-Dokumentation beachtet werden:
				</simpara>
				<itemizedlist>
					<listitem>
						<simpara>
						<ulink url="http://technet.microsoft.com/de-de/library/hh125922%28v=ws.10%29.aspx"/>.
						</simpara>
					</listitem>
				</itemizedlist>
			</note>
			<section id="school:exam:gpo:usb:xp">
				<title>Zugriff auf USB-Speicher an Windows XP einschränken</title>
				<para>
					Diese Richtlinie wird über eine Administrative Vorlage (ADMX) definiert, die in Microsoft Knowledgebase Artikel 555324.
					<footnote><para><ulink url="http://support.microsoft.com/kb/555324"/></para></footnote> beschrieben ist.
					Erst nach Einbinden der Administrative Vorlage (ADMX) können folgende Einstellungen getroffen werden.
					Beispiele für ADMX-Dateien liegen unter <filename>/usr/share/doc/ucs-school-umc-exam/examples/GPO</filename>.
					Zum Einbinden der ADMX-Dateien müssen diese auf die <filename>SYSVOL</filename>-Freigabe kopiert werden (siehe <xref linkend="school:exam:gpo:general"/>).
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen</guisubmenu> &ar; <guisubmenu>Spezielle Einstellungen</guisubmenu> &ar; <guisubmenu>Treiber einschränken</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>USB Sperren</emphasis> öffnen, <emphasis>Aktiviert</emphasis> auswählen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
				<note>
					<simpara>
					Hier stehen auch weitere Gerätetypen zur Auswahl, z.B. CD-ROM-Laufwerke.
					</simpara>
				</note>
			</section>
			<section id="school:exam:gpo:usb:xp:drivers">
				<title>Installation neuer Gerätetreiber für USB-Speicher an Windows XP verbieten</title>
				<para>
					Diese Richtlinie definiert eingeschränkte Dateisystemberechtigungen gemäß Microsoft Knowledgebase Artikel 823732
					<footnote><para><ulink url="http://support.microsoft.com/kb/823732"/></para></footnote>.
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Windows-Einstellungen</guisubmenu> &ar; <guisubmenu>Sicherheitseinstellungen</guisubmenu> &ar; <guisubmenu>Dateisystem</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Rechtsklick auf <emphasis>Datei hinzufügen...</emphasis>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Das Verzeichnis <filename class="directory">C:\Windows\Inf</filename> ansteuern und dort die Datei <filename>usbstor.inf</filename> auswählen und mit <emphasis>OK</emphasis> bestätigen (ggf. wird die Dateiendung <filename class="extension">.inf</filename> nicht mit angezeigt).
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In dem neu geöffneten Dialog <emphasis>Datenbanksicherheit für ...</emphasis>  in der oberen Liste <emphasis>Gruppen- oder Benutzernamen</emphasis> die Schaltfläche <emphasis>Hinzufügen</emphasis> betätigen und den Namen der Klassenarbeitsgruppe hinzufügen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In der darunter angezeigten Liste <emphasis>Berechtigungen für ...</emphasis> in der Zeile <emphasis>Vollzugriff</emphasis>, Spalte <emphasis>Verweigern</emphasis> ein Häkchen setzen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Den Dialog <emphasis>Datenbanksicherheit für ...</emphasis> mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Das neue Dialogfenster <emphasis>Windows-Sicherheit</emphasis> mit <emphasis>Ja</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Das neue Dialogfenster <emphasis>Objekt hinzufügen</emphasis> mit <emphasis>OK</emphasis> schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Analog sollten Einstellungen für <filename>%SystemRoot%\inf\usbstor.pnf</filename> und <filename>%SystemRoot%\system32\drivers\usbstor.sys</filename> definiert werden.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section id="school:exam:gpo:usb:w7">
				<title>Zugriff auf USB-Speicher an Windows 7 einschränken</title>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Benutzerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen</guisubmenu> &ar; <guisubmenu>System</guisubmenu> &ar; <guisubmenu>Wechselmedienzugriff</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Z.B. Richtlinie <emphasis>Wechseldatenträger: Lesezugriff verweigern</emphasis> öffnen, <emphasis>Aktiviert</emphasis> auswählen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
				<note>
					<simpara>
					Weitere Informationen zu diesem Thema liefert z.B. <ulink url="http://technet.microsoft.com/de-de/library/cc771759%28v=ws.10%29.aspx"/>.
					</simpara>
				</note>
			</section>
			<section id="school:exam:gpo:usb:w7:drivers">
				<title>Installation neuer Gerätetreiber für USB-Speicher an Windows 7 Clients verbieten</title>
				<para>
					Zusätzliche Einschränkungen zur Installation von Gerätetreibern sind auch unter Windows 7 möglich. Die Einstellungsmöglichkeiten bieten eine größere Kontrolle, setzen aber auch konkrete Erfahrungen mit den im Einzelfall eingesetzten Geräten voraus. Daher ist dieser Abschnitt nur als Einstiegshilfe zu verstehen. Die folgende Einstellung würde die zusätzliche Installation jeglicher Treiber für Wechselgeräte deaktivieren. Es kann hier z.B. dann zusätzlich sinnvoll sein, Administratoren von dieser Einschränkung auszunehmen.
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen</guisubmenu> &ar; <guisubmenu>System</guisubmenu> &ar; <guisubmenu>Geräteinstallation</guisubmenu> &ar; <guisubmenu>Einschränkungen bei der Geräteinstallation</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Hier kann die Installation von Treibern für bestimmte Geräteklassen, Geräte-IDs oder alle Wechselgeräte eingeschränkt werden.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Installation von Wechselgeräten verhindern</emphasis> öffnen, <emphasis>Aktiviert</emphasis> auswählen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Die Richtlinie <emphasis>Administratoren das Außerkraftsetzen der Richtlinien unter ... erlauben</emphasis> erlaubt Mitgliedern der Administratorengruppe die getroffenen Einschränkungen zu umgehen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Noch stärkere Restriktionen sind möglich, indem man die Ausschlusslogik auf Whitelisting umstellt. Dies kann über die Richtlinie <emphasis>Installation von Geräten verhindern, die nicht in anderen Richtlinien beschrieben sind</emphasis> erreicht werden.
						</simpara>
					</listitem>
				</itemizedlist>

				<note>
					<simpara>
					Weitere Informationen zu diesem Thema liefert z.B. <ulink url="http://technet.microsoft.com/de-de/library/cc731387%28v=ws.10%29.aspx"/>.
					</simpara>
				</note>
			</section>
		</section>

		<section id="school:exam:gpo:proxy">
			<title>Vorgabe von Proxy-Einstellungen für den Internetzugriff</title>
			<para>
				Im Folgenden sind Vorgaben für Internet Explorer, Google Chrome und Mozilla Firefox beschrieben. Während Microsoft selbst Administrative Vorlagen mitliefert, sind für Google Chrome und Mozilla Firefox jeweils eigene Administrative Vorlagen notwendig.
			</para>
			<para>
				Zusätzlich zur Vorgabe einer Proxyeinstellung ist für den Klassenarbeitsmodus eine Sperrung des Benutzer-Zugriffs auf eben diese Einstellungen sinnvoll. Dazu gibt es zwei unterschiedliche Ansätze: Im Fall des Internet Explorers bietet die Administrative Vorlage die Möglichkeit, das entsprechende Einstellungsfenster zu sperren. Im Fall von Google Chrome und Mozilla Firefox werden hingegen die Proxy-Einstellungen per Gruppenrichtlinie für den Arbeitsplatzrechner vorgegeben, statt für den Benutzer, und sind dadurch z.B. für Schüler nicht mehr veränderbar. Für die beiden letztgenannten Browser ist es daher wichtig darauf zu achten, die Einstellungen, wo nötig, im Zweig <emphasis>Computerkonfiguration</emphasis> des Gruppenrichtlinieneditors statt im Zweig <emphasis>Benutzerkonfiguration</emphasis> zu treffen.
			</para>
			<section id="school:exam:gpo:proxy:ie">
				<title>Proxy-Vorgabe für den Internet Explorer</title>
				<itemizedlist>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Benutzerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Windows-Einstellungen</guisubmenu> &ar; <guisubmenu>Internet Explorer-Wartung</guisubmenu> &ar; <guisubmenu>Verbindung</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Proxyeinstellungen</emphasis> öffnen, <emphasis>Aktiviert</emphasis> auswählen und bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Proxyadresse für <emphasis>HTTP</emphasis> sowie <emphasis>Secure</emphasis> und das entsprechende <emphasis>Port</emphasis>-Feld ausfüllen (Wert der &ucsUCRV; <envar>squid/httpport</envar>, Standard 3128)
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Ggf. <emphasis>Für alle Adressen denselben Proxyserver verwenden</emphasis> aktivieren.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section id="school:exam:gpo:proxy:ie:lock">
				<title>Sperrung der Proxyeinstellung für den Internet Explorer</title>
				<itemizedlist>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen: Vom zentralen Computer abgerufene Richtliniendefinitionen (ADMX-Dateien)</guisubmenu> &ar; <guisubmenu>Windows-Komponenten</guisubmenu> &ar; <guisubmenu>Internet Explorer</guisubmenu> &ar; <guisubmenu>Internetsystemsteuerung</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Verbindungsseite deaktivieren</emphasis> öffnen und  <emphasis>Aktiviert</emphasis> auswählen und bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section id="school:exam:gpo:proxy:chrome">
				<title>Proxy-Vorgabe für Google Chrome</title>
				<para>
					Die Administrativen Vorlagen für Google Chrome werden durch das Zip-Archiv <filename>policy_templates.zip</filename> des Chromium-Projekts bereitgestellt. Die entsprechenden Dateien liegen unter <filename class="directory">/usr/share/doc/ucs-school-umc-exam/examples/GPO/</filename>.  Der Inhalt des <filename class="directory">admx</filename>-Verzeichnisses sollte in das Verzeichnis <filename>PolicyDefinitions</filename> auf den Schulserver kopiert werden, so dass dort die Datei <filename>chrome.admx</filename> liegt. Die <filename>*.adml</filename>-Dateien aus den Unterverzeichnissen müssen in gleichnamige Unterverzeichnisse unter <filename>PolicyDefinitions</filename> kopiert werden.
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen: Vom zentralen Computer abgerufene Richtliniendefinitionen (ADMX-Dateien)</guisubmenu> &ar; <guisubmenu>Google</guisubmenu> &ar; <guisubmenu>Google Chrome</guisubmenu> &ar; <guisubmenu>Proxy-Server</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Auswählen, wie Proxy-Server-Einstellungen angegeben werden</emphasis> öffnen und <emphasis>Aktiviert</emphasis> auswählen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dropdown <emphasis>System-Proxy-Einstellungen verwenden</emphasis> auswählen und bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section id="school:exam:gpo:proxy:firefox">
				<title>Proxy-Vorgabe für Mozilla Firefox</title>
				<para>
					Auf dem Schulserver sollte das Verzeichnis <filename>/var/lib/samba/sysvol/DomänenNameDerUCS@schoolUmgebung/Policies/PolicyDefinitions/</filename> angelegt werden. Nähere Informationen sind im Abschnitt zu Google Chrome zu finden.
				</para>
				<para>
					Die Administrativen Vorlagen für Mozilla Firefox werden durch das FirefoxADM-Projekt bereitgestellt. Es ist sinnvoll die dort definierten ADM-Vorlagen in das ADMX-Format umzuwandeln. Beispiele für ADMX Dateien liegen unter <filename>/usr/share/doc/ucs-school-umc-exam/examples/GPO</filename>. Der Inhalt des <filename>admx</filename>-Verzeichnisses sollte in das Verzeichnis <filename>PolicyDefinitions</filename>  auf den Schulserver kopiert werden, so dass dort die Datei <filename>firefoxlock.admx</filename> liegt. Die <filename>*.adml</filename>-Dateien aus den Unterverzeichnissen müssen in gleichnamige Unterverzeichnisse unter <filename>PolicyDefinitions</filename> kopiert werden.
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen: Vom zentralen Computer abgerufene Richtliniendefinitionen (ADMX-Dateien)</guisubmenu> &ar; <guisubmenu>Mozilla Firefox Locked Settings</guisubmenu> &ar; <guisubmenu>General</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis lang="en">Proxy Settings</emphasis> öffnen und <emphasis>Aktiviert</emphasis> auswählen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dropdown <emphasis lang="en">Preference State</emphasis> die Einstellung <emphasis lang="en">Locked</emphasis> auswählen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dropdown <emphasis lang="en">Proxy Setting</emphasis> die Einstellung <emphasis lang="en">Manual Proxy Configuration</emphasis> auswählen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Feld <emphasis lang="en">Proxy Setting</emphasis> die Einstellung <emphasis lang="en">Manual Setting - HTTP Proxy</emphasis> eintragen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Feld <emphasis lang="en">HTTP Proxy Port</emphasis> den Proxy Port eintragen (Wert der &ucsUCRV; <envar>squid/httpport</envar>, Standard 3128)
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Den Dialog mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
				<para>
					Da Mozilla Firefox bisher nicht selbständig die über die Administrativen Vorlagen definierten Einstellungen in der Windows-Registry berücksichtigt, ist es notwendig diese Einstellungen über ein Startup- bzw. Shutdown-Skript in Mozilla-Konfigurationsdateien übersetzen zu lassen. Das <wordasword>FirefoxADM</wordasword>-Projekt stellt diese Skripte in Form von zwei <filename class="extension">vbs</filename>-Dateien zur Verfügung. Deren Einbindung ist über die folgenden Schritt möglich.
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Computerkonfiguration</guisubmenu> &ar; <guisubmenu>Windows-Einstellungen</guisubmenu> &ar; <guisubmenu>Skripts (Start/Herunterfahren)</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Starten</emphasis> öffnen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dialog <emphasis>Eigenschaften von Starten</emphasis> auf dem Reiter <emphasis>Skripts</emphasis> die Schaltfläche <emphasis>Dateien anzeigen</emphasis> betätigen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das vom automatisch geöffneten Windows Explorer angezeigte (leere) Verzeichnis (<filename>Machine\Scripts\Startup</filename> im betreffenden GPO-Verzeichnis) die Datei <filename>firefox_startup.vbs</filename> kopieren und das Explorer-Fenster schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dialog <emphasis>Eigenschaften von Starten</emphasis> die Schaltfläche <emphasis>Hinzufügen</emphasis> betätigen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im neu geöffneten Dialog <emphasis>Hinzufügen eines Skripts</emphasis> neben dem Feld <emphasis>Skriptname</emphasis> den Namen <filename>firefox_startup.vbs</filename> eintragen und Dialog mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dialog <emphasis>Eigenschaften von Starten</emphasis> den Dialog mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Herunterfahren</emphasis> öffnen, und dort analog zu dem Vorgehen bei <emphasis>Starten</emphasis> das Skript <filename>firefox_shutdown.vbs</filename> eintragen. Im Detail also:
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dialog <emphasis>Eigenschaften von Herunterfahren</emphasis> die Schaltfläche <emphasis>Hinzufügen</emphasis> betätigen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das vom automatisch geöffneten Windows Explorer angezeigte (leere) Verzeichnis (<filename>Machine\Scripts\Shutdown</filename> im betreffenden GPO-Verzeichis) die Datei <filename>firefox_shutdown.vbs</filename> kopieren und das Explorer-Fenster schließen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im neu geöffneten Dialog <emphasis>Hinzufügen eines Skripts</emphasis> neben dem Feld <emphasis>Skriptname</emphasis> den Namen <filename>firefox_shutdown.vbs</filename> eintragen und Dialog mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im Dialog <emphasis>Eigenschaften von Herunterfahren</emphasis> den Dialog mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
		</section>


		<section id="school:exam:gpo:cmd">
			<title>Zugriff auf bestimmte Programme einschränken</title>
			<note>
				<para>
				Die Liste der hier erwähnten Einstellungen erhebt nicht den Anspruch der Vollständigkeit. Es ist notwendig die Einstellungen entsprechend der lokalen Gegebenheiten zu testen. Insbesondere sollten folgende Microsoft-Dokumentationen beachtet werden:
				</para>
				<itemizedlist>
					<listitem>
						<simpara>
						<ulink url="http://technet.microsoft.com/en-us/library/bb457006.aspx#EGAA"/>.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						<ulink url="http://technet.microsoft.com/en-us/library/hh994606.aspx"/>.
						</simpara>
					</listitem>
				</itemizedlist>
			</note>
			<section id="school:exam:gpo:cmd:cli">
				<title>Kommandoeingabeaufforderung deaktivieren</title>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Benutzerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen</guisubmenu> &ar; <guisubmenu>System</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Zugriff auf Eingabeaufforderung verhindern</emphasis> öffnen und  <emphasis>Aktiviert</emphasis> auswählen und bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section  id="school:exam:gpo:cmd:regedit">
				<title>Zugriff auf Windows-Registry-Editor deaktivieren</title>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Benutzerkonfiguration</guisubmenu> &ar; <guisubmenu>Richtlinien</guisubmenu> &ar; <guisubmenu>Administrative Vorlagen</guisubmenu> &ar; <guisubmenu>System</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Richtlinie <emphasis>Zugriff auf Programme zum Bearbeiten der Registrierung verhindern</emphasis> öffnen
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						<emphasis>Aktiviert</emphasis> auswählen und den Dialog mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
			<section id="school:exam:gpo:cmd:srp">
				<title>Konfiguration von <foreignphrase>Software Restriction Policies</foreignphrase> (SRP)</title>
				<para>
					Aufgrund der Tiefe des Eingriffs der <foreignphrase>Software Restriction Policies</foreignphrase> ist zu empfehlen, diese zunächst in einer Testumgebung zu auszuprobieren. Bei der Analyse von Zugriffsfehlern kann die Ereignisanzeige des Windows-Clients helfen
					<footnote id="Application_Whitelisting_Using_SRP">
						<para>
							Weitere sinnvolle Hinweise zur Analyse und Pflege der Software Restriction Policies liefert z.B.
							<ulink url="http://www.nsa.gov/ia/_files/os/win2k/Application_Whitelisting_Using_SRP.pdf"/>
						</para>
					</footnote>.
				</para>
				<para>
					Die <foreignphrase>Software Restriction Policies</foreignphrase> greifen auch in die Bearbeitung von Login- und Logoff-Skripten ein. Alle dort verwendeten Programme bzw. Programmpfade sollten auf Ausführbarkeit getestet werden.
				</para>
				<note>
					<simpara>
					Die Liste der hier erwähnten Einstellungen erhebt nicht den Anspruch der Vollständigkeit. Es ist notwendig die Einstellungen entsprechend der lokalen Gegebenheiten zu testen. Insbesondere sollte folgende Microsoft-Dokumentation beachtet werden:
					</simpara>
					<itemizedlist>
						<listitem>
							<simpara>
								<ulink url="http://technet.microsoft.com/en-us/library/bb457006.aspx#EGAA"/>.
							</simpara>
						</listitem>
						<listitem>
							<simpara>
								<ulink url="http://technet.microsoft.com/en-us/library/hh994606.aspx"/>.
							</simpara>
						</listitem>
					</itemizedlist>
				</note>
				<itemizedlist>
					<listitem>
						<simpara>
						In der Gruppenrichtlinienverwaltung ein neues Gruppenrichtlinienobjekt anlegen und/oder ein existierendes Gruppenrichtlinienobjekt zur Bearbeitung öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							Im Gruppenrichtlinienverwaltungseditor den folgenden Zweig öffnen:
						</simpara>
						<simpara>
							<guisubmenu>Benutzerkonfiguration</guisubmenu> &ar; <guisubmenu>Windows-Einstellungen</guisubmenu> &ar; <guisubmenu>Sicherheitseinstellungen</guisubmenu> &ar; <guisubmenu>Richtlinien für Softwareeinschränkung</guisubmenu>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Rechtsklick auf <emphasis>Neue Richtlinien für Softwareeinschränkung erstellen</emphasis>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im rechten Fensterteil <emphasis>Erzwingen</emphasis> öffnen,
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Einstellung <emphasis>Alle Benutzer außer den lokalen Administratoren</emphasis> auswählen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im rechten Fensterteil <emphasis>Sicherheitsstufen</emphasis> öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						<emphasis>Nicht erlaubt</emphasis> per Doppelklick öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						<emphasis>Als Standard</emphasis> auswählen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Im rechten Fensterteil <emphasis>Zusätzliche Regeln</emphasis> öffnen.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						Rechtsklick auf <emphasis>Neue Pfadregel...</emphasis>
						</simpara>
					</listitem>
					<listitem>
						<simpara>
						In das Eingabefeld <emphasis>Pfad</emphasis> den UNC-Pfad <filename>\\%USERDNSDOMAIN%\SysVol</filename> eingeben, damit Logon- und GPO-Skripte ausgeführt werden können.
						</simpara>
					</listitem>
					<listitem>
						<simpara>
							In der Dropdown-Liste <emphasis>Nicht eingeschränkt</emphasis> auswählen und mit <emphasis>OK</emphasis> bestätigen.
						</simpara>
							<table>
								<title>Beispiele für weitere Pfadregeln</title>
								<tgroup cols="2">
									<colspec colnum="1" colname="col1" colwidth="2*"/>
									<colspec colnum="2" colname="col2" colwidth="1*"/>
									<thead>
										<row>
											<entry>Pfad</entry>
											<entry>Sicherheitsstufe</entry>
										</row>
									</thead>
									<tbody>
										<row>
											<entry><filename>\\%USERDNSDOMAIN%\SysVol</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>\\%LogonServer%\SysVol</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>\\%LogonServer%\netlogon</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>\\%COMPUTERNAME%\Templates$\*</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>%UserProfile%\Local Settings\Temp\*.tmp</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>%WinDir%\system32\cscript.exe</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>%WinDir%\system32\wscript.exe</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>%ProgramFiles%</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>%ProgramFiles(x86)%</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
										<row>
											<entry><filename>*.lnk</filename></entry>
											<entry>Nicht eingeschränkt</entry>
										</row>
									</tbody>
								</tgroup>
							</table>
					</listitem>
					<listitem>
						<simpara>
							Es kann sinnvoll sein zusätzlich Programm-Pfade als <emphasis>Nicht erlaubt</emphasis> einzustufen, z.B.:
						</simpara>
							<table>
								<title>Beispiele für weitere Pfadregeln</title>
								<tgroup cols="2">
									<colspec colnum="1" colname="col1" colwidth="2*"/>
									<colspec colnum="2" colname="col2" colwidth="1*"/>
									<thead>
										<row>
											<entry>Pfad</entry>
											<entry>Sicherheitsstufe</entry>
										</row>
									</thead>
									<tbody>
										<row>
											<entry><filename>%UserProfile%\Local Settings\Temp</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemRoot%\temp\*</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemRoot%\System32\mstsc.exe</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemRoot%\System32\dllcache\*</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemRoot%\System32\command.com</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemRoot%\System32\cmd.exe</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemRoot%\repair\*</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
										<row>
											<entry><filename>%SystemDrive%\temp\*</filename></entry>
											<entry>Nicht erlaubt</entry>
										</row>
									</tbody>
								</tgroup>
							</table>
					</listitem>
					<listitem>
						<simpara>
						Es sollte beachtet werden, dass schreibbare Verzeichnisse, auf die der Zugriff nicht per Software Restriction Policy eingeschränkt ist, Benutzern die Möglichkeit geben, Programmdateien dort abzulegen und so die definierten Regeln zu umgehen
						<footnote id="Application_Whitelisting_Using_SRP2">
							<para>
								Weitere sinnvolle Hinweise zur Analyse und Pflege der Software Restriction Policies liefert z.B.
								<ulink url="http://www.nsa.gov/ia/_files/os/win2k/Application_Whitelisting_Using_SRP.pdf"/>
							</para>
						</footnote>.
						</simpara>
					</listitem>
				</itemizedlist>
			</section>
		</section>
	</section>
</chapter>
